import pygame
from pygame.locals import *
from sys import exit
from random import randint

pygame.init()

# criando tela
largura = 600
altura = 600
tela = pygame.display.set_mode((largura, altura))
pygame.display.set_caption('Jogo')

# variaveis iniciais
cianos = vermelhos = marrons = 0
vivo = True
velocidade = 10
velocidade_vilao = 15
x_controle = 0
y_controle = 0
lista = []

relogio = pygame.time.Clock()
fonte = pygame.font.SysFont('arial', 25, bold=True, italic=True)
fonte2 = pygame.font.SysFont('arial', 16, bold=True, italic=True)
fonte_placar = pygame.font.SysFont('arial', 15, True, True)


class Player:
    def __init__(self, cor, pos_x, pos_y):
        self.cor = cor
        self.pos_x = pos_x
        self.pos_y = pos_y

    def andar(self):
        global x_controle, y_controle
        if event.key == K_LEFT:
            x_controle = -velocidade
            y_controle = 0
        if event.key == K_RIGHT:
            x_controle = velocidade
            y_controle = 0
        if event.key == K_UP:
            x_controle = 0
            y_controle = -velocidade
        if event.key == K_DOWN:
            x_controle = 0
            y_controle = velocidade
        if player.pos_x > largura:
            player.pos_x = 0
        if player.pos_x < 0:
            player.pos_x = largura
        if player.pos_y > altura:
            player.pos_y = 0
        if player.pos_y < 0:
            player.pos_y = altura

    def colidiu(self, coletavel):
        global Coletaveis, cianos, vermelhos, marrons
        if coletavel.pos_x -30 <  player.pos_x and player.pos_x < coletavel.pos_x + 10:
            if coletavel.pos_y - 20 < player.pos_y and player. pos_y < coletavel.pos_y + 10:
                coletavel.pos_x = randint(0,largura-10)
                coletavel.pos_y = randint(51,altura-10)
                if coletavel == vermelho:
                    vermelhos += 1
                if coletavel == ciano:
                    cianos += 1
                if coletavel == marrom:
                    marrons += 1
    def desenhar(self):
        pygame.draw.rect(tela, (0,0,255), (self.pos_x, self.pos_y, 25, 25))

class Coletaveis:
    def __init__(self, cor, pos_x, pos_y):
        self.cor = cor
        self.pos_x = pos_x
        self.pos_y = pos_y

    def desenhar_coletaveis(self):
        pygame.draw.rect(tela, self.cor, (self.pos_x, self.pos_y, 15, 15))

class Vilao():
    def __init__(self, cor, pos_x, pos_y):
        self.cor = cor
        self.pos_x = pos_x
        self.pos_y = pos_y

    def desenhar_vilao(self):
        pygame.draw.rect(tela, self.cor, (self.pos_x, self.pos_y, 20, 20))


def reiniciar_jogo():
    global menu
    menu = True


menu = True
while menu:
    tela.fill((0, 0, 0))

    inicio = ('Pressione a barra de espaÃ§o para iniciar')
    texto_formatado3 = fonte.render(inicio, True, (255, 255, 255))
    tela.blit(texto_formatado3, (100, altura / 2))
    pygame.display.update()
    for event in pygame.event.get():
        if event.type == QUIT:
            exit()
        if event.type == KEYDOWN:
            if event.key == K_SPACE:
                menu = False

    pygame.display.update()

player = Player((0,0,255), largura//2, altura//2 )
vermelho = Coletaveis((255, 0, 0), (randint(0, largura - 30)//10*10), (randint(50, altura - 30)//10*10))
ciano = Coletaveis((0, 255, 255), (randint(0, largura - 30)//10*10), (randint(50, altura - 30)//10*10))
marrom = Coletaveis((150, 75, 0), (randint(0, largura - 30)//10*10), (randint(50, altura - 30)//10*10))
lista.append(ciano)
lista.append(vermelho)
lista.append(marrom)

while vivo:
    tela.fill((0,0,0))
    mensagem = (f'Cianos: {cianos} | Marrons:{marrons} | Vermelhos:{vermelhos}')
    texto_formatado = fonte_placar.render(mensagem, True, (255, 255, 255), True)

    relogio.tick(30)
    player.desenhar()
    vermelho.desenhar_coletaveis()
    ciano.desenhar_coletaveis()
    marrom.desenhar_coletaveis()
    pygame.draw.line(tela, (150, 75, 0), (0, 50), (largura, 50), 5)

    for event in pygame.event.get():
        if event.type == QUIT:
            exit()
        if event.type == KEYDOWN:
            player.andar()
    for coletavel in lista:
        player.colidiu(coletavel)
    player.pos_x += x_controle
    player.pos_y += y_controle
    if player.pos_x > largura:
        player.pos_x = 0
    if player.pos_y > altura:
        player.pos_y = 0
    tela.blit(texto_formatado, (20, altura // 20))
    pygame.display.update()
